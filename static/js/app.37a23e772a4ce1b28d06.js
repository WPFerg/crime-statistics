webpackJsonp([1],[,,,,,,,,,function(t,e,n){"use strict";n.d(e,"a",function(){return r}),n.d(e,"b",function(){return a});var r="RETRIEVE_CRIME_DATA",a="RECEIVE_CRIME_DATA"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var r=n(15),a=n(113),o=n(107),i=n.n(o);r.a.use(a.a),e.a=new a.a({routes:[{path:"/:postcode",name:"Hello",component:i.a,props:!0},{path:"/",name:"Hello",component:i.a,props:!0}]})},function(t,e,n){"use strict";var r=n(48),a=n(49),o=n(50),i=n(51),u=n(52),s=n(15),c=n(116);s.a.use(c.a),e.a=new c.a.Store({actions:r.a,getters:a.a,mutations:o.a,plugins:i.a,state:u.a})},function(t,e,n){n(105);var r=n(8)(n(53),n(111),null,null);t.exports=r.exports},function(t,e,n){n(102);var r=n(8)(n(54),n(108),"data-v-0339d565",null);t.exports=r.exports},function(t,e,n){n(103);var r=n(8)(n(55),n(109),null,null);t.exports=r.exports},function(t,e,n){n(106);var r=n(8)(n(57),n(112),"data-v-c1ba638a",null);t.exports=r.exports},function(t,e,n){"use strict";var r=n(62),a=n.n(r);n.d(e,"a",function(){return o});var o=function(t){return fetch("//api.postcodes.io/postcodes/"+t).then(function(t){return t.ok?t:a.a.reject()}).catch(function(){return fetch("//api.postcodes.io/outcodes/"+t+"/nearest")}).then(function(t){return t.json()}).then(function(t){var e=t.result;return Array.isArray(e)?e[0]:e}).then(function(t){var e=t.latitude,n=t.longitude;return fetch("//data.police.uk/api/crimes-street/all-crime?lat="+e+"&lng="+n)}).then(function(t){return t.json()})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(15),a=n(42),o=n.n(a),i=n(40),u=n(41),s=n(43),c=n.n(s),l=n(44),d=n.n(l),p=n(45),h=n.n(p);r.a.component("crime-info",c.a),r.a.component("doughnut-chart",d.a),r.a.component("summary-card",h.a),r.a.config.productionTip=!1,new r.a({el:"#app",router:i.a,store:u.a,template:"<App/>",components:{App:o.a}})},function(t,e,n){"use strict";var r=n(27),a=n.n(r),o=n(9),i=n(46);e.a=a()({},o.a,function(t,e){var r=t.commit;e&&(r(o.a),n.i(i.a)(e).then(function(t){r(o.b,t)}))})},function(t,e,n){"use strict";e.a={crimeByType:function(t){return t.crime.reduce(function(t,e){return t[e.category]||(t[e.category]=[]),t[e.category].push(e),t},{})}}},function(t,e,n){"use strict";var r,a=n(27),o=n.n(a),i=n(9);e.a=(r={},o()(r,i.a,function(t){t.retrievingData=!0}),o()(r,i.b,function(t,e){t.crime=e,t.retrievingData=!1}),r)},function(t,e,n){"use strict";var r=n(115),a=n.n(r);e.a=[a()()]},function(t,e,n){"use strict";e.a={crime:[],retrievingData:!1}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"app",data:function(){return{inputValue:""}},methods:{startSearch:function(){this.$router.push("/"+this.inputValue),this.inputValue=""}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"crime-info",props:{data:{type:Array},title:{type:String}},data:function(){return{resolutions:[]}},created:function(){this.aggregateData()},beforeUpdate:function(){this.aggregateData()},methods:{aggregateData:function(){this.resolutions=this.data.reduce(function(t,e){var n=e.outcome_status&&e.outcome_status.category,r=n||"No Status";return t[r]||(t[r]=0),t[r]++,t},{})}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(63),a=n.n(r),o=n(61),i=n.n(o),u=n(101);n.n(u),n(9);e.default={name:"doughnut-chart",props:{data:{type:Array},accessor:{type:Function}},mounted:function(){this.initialiseDoughnut(),this.recalculateGroupings(),this.render()},data:function(){return{pie:null,rootNode:null,renderNode:null,colourScale:null,legendNode:null,arc:null,groupedData:[]}},watch:{data:function(){this.recalculateGroupings(),this.render()}},methods:{recalculateGroupings:function(){var t=this,e=this.data.reduce(function(e,n){var r=t.accessor(n);return e[r]||(e[r]=0),e[r]++,e},{});this.groupedData=i()(e).map(function(t){return[t,e[t]]})},initialiseDoughnut:function(){this.rootNode=u.select(this.$refs.svg),this.pie=u.pie().sort(null).value(function(t){return t[1]}),this.width=Number(this.rootNode.attr("width")),this.height=Number(this.rootNode.attr("height"));var t=Math.min(this.width,this.height);this.arc=u.arc().outerRadius(t/2).innerRadius(t/4),this.renderNode=this.rootNode.append("g").attr("transform","translate("+t/2+", "+t/2+")"),this.legendNode=this.rootNode.append("g").attr("transform","translate("+(t+5)+", 0)")},render:function(){this.colourScale=u.scaleOrdinal(u.schemeCategory20),this.renderDoughnut(),this.renderLegend()},renderDoughnut:function(){var t=this,e=this.groupedData,n=this.pie(e),r=this.renderNode.selectAll("g.arc").data(n),a=r.enter().append("g").classed("arc",!0).merge(r),o=a.selectAll("path").data(function(t){return[t]});o.enter().append("path").on("mouseover",function(e){return t.renderTooltip([e.data[0]+" ("+e.data[1]+")"])}).on("mousemove",function(e){return t.renderTooltip([e.data[0]+" ("+e.data[1]+")"])}).on("mouseout",function(e){return t.renderTooltip([])}).merge(o).attr("fill",function(e){return t.colourScale(e.data[0])}).transition().duration(2e3).attrTween("d",function(e){var n=u.interpolate(0,e.startAngle),r=u.interpolate(0,e.endAngle);return function(a){return e.startAngle=n(a),e.endAngle=r(a),t.arc(e)}}),r.exit().remove()},renderLegend:function(){var t=this,e=this.groupedData.slice(0,15),n=this.legendNode.selectAll("g").data(e),r=Math.max(0,Math.min(20,this.height/e.length-2)),a=n.enter().append("g");a.append("rect").attr("x",0).attr("y",0),a.append("text").attr("dy","0.35em");var o=a.merge(n).transition().duration(2e3).attrTween("transform",function(t,e){var n=u.interpolate(-2-r,(r+2)*e);return function(t){return"translate(0, "+n(t)+")"}});o.select("rect").attr("width",r).attr("height",r).attr("fill",function(e){return t.colourScale(e[0])}),o.select("text").attr("y",r/2).attr("x",r+2).text(function(t){return t[0]+" ("+t[1]+")"}),n.exit().transition().remove()},renderTooltip:function(t){var e=u.mouse(this.rootNode.node()),n=a()(e,2),r=n[0],o=n[1],i=this.rootNode.selectAll("g.tooltip").data(t),s=i.enter().append("g").classed("tooltip",!0);s.append("rect").classed("doughnut-tooltip",!0).attr("x",0).attr("y",0),s.append("text").attr("x",10).attr("y",10).attr("dy","0.71em");var c=s.merge(i).attr("transform","translate("+(r+30)+", "+(o+30)+")");c.selectAll("text").data(function(t){return[t]}).text(function(t){return t}),c.each(function(){var t=u.select(this),e=t.select("text").node().getBoundingClientRect();t.select("rect").attr("width",e.width+20).attr("height",e.height+20)}),i.exit().remove()}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(9);e.default={name:"hello",props:{postcode:{type:String}},created:function(){this.retrieveData()},computed:{crimeCount:function(){return this.$store.state.crime.length.toLocaleString()}},methods:{retrieveData:function(){this.$store.dispatch(r.a,this.postcode)},getCategory:function(t){return t.category},getLocation:function(t){return t.location.street.name},getOutcome:function(t){return t.outcome_status?t.outcome_status.category:"No Outcome"}},watch:{postcode:function(){this.retrieveData()}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"summary-card",props:{title:{type:String},subtitle:{type:String}}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e,n){n(104);var r=n(8)(n(56),n(110),"data-v-7afc12f7",null);t.exports=r.exports},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"crime-info"},[n("h3",[t._v(t._s(t.title))]),t._v(" "),n("h4",[t._v(t._s(this.data.length)+" total")]),t._v(" "),n("ul",t._l(t.resolutions,function(e,r){return n("li",{staticClass:"breakdown"},[t._v("\n      "+t._s(r)+": "+t._s(e)+"\n    ")])}))])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("svg",{ref:"svg",attrs:{width:"600",height:"300"}})},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"hello"},[t.$store.state.retrievingData?n("div",[t._v("\n    Loading data...\n  ")]):n("div",[n("div",{staticClass:"summary"},[n("summary-card",{attrs:{title:t.crimeCount,subtitle:"crimes committed in a 1 mile radius (last month)"}})],1),t._v(" "),n("div",{staticClass:"doughnut-chart"},[n("doughnut-chart",{attrs:{data:t.$store.state.crime,accessor:t.getCategory}}),t._v(" "),n("doughnut-chart",{attrs:{data:t.$store.state.crime,accessor:t.getLocation}}),t._v(" "),n("doughnut-chart",{attrs:{data:t.$store.state.crime,accessor:t.getOutcome}})],1),t._v(" "),n("div",{staticClass:"crimes-breakdown"},t._l(t.$store.getters.crimeByType,function(t,e){return n("crime-info",{key:e,attrs:{title:e,data:t}})}))])])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.inputValue,expression:"inputValue"}],attrs:{placeholder:"Postcode"},domProps:{value:t.inputValue},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13))return null;t.startSearch(e)},input:function(e){e.target.composing||(t.inputValue=e.target.value)}}}),t._v(" "),n("hr"),t._v(" "),n("router-view")],1)},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"summary-card"},[n("h3",[t._v(t._s(t.title))]),t._v(" "),n("h4",[t._v(t._s(t.subtitle))])])},staticRenderFns:[]}}],[47]);
//# sourceMappingURL=app.37a23e772a4ce1b28d06.js.map